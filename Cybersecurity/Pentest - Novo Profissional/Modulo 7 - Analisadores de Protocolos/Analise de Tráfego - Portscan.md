
---

1. Após iniciar uma analise de um tráfego devo iniciar filtrando por ip, utilizando o comando ``cut -d`` para delimitar a linha que contem o IP.
 ![](https://i.imgur.com/mEpjodP.png)

2. Caso ao trazer o IP venha informações desnecessária, podemos utilizar o comando ``grep -v`` e passa oque não quero que retorne, no exemplo abaixo eu não quero que retorne a palavra **TTL**.

![](https://i.imgur.com/ZGVVfpp.png)

3. Após fazer esses filtros irei conseguir ter uma noção do IP de origem e o IP de destino, com isso irei usar os comandos do tcpdump para filtrar somente o endereço de origem, utilizando o comando ``src host (ip de origem)``.

![](https://i.imgur.com/gbEndLO.png)

4. Com o IP de origem fica mais fácil eu conseguir filtrar, agora posso usar o ``cut`` para delimitar onde contem as informações sobre as flags.

![](https://i.imgur.com/GIzmc4v.png)

5. Agora que conseguimos ter visão das flags podemos desconsiderar aquelas que contenha  o "S", pois significa que o IP de origem esta tentando uma conexão com o IP de destino, isso não significa que a porta ao qual o IP de origem esta tentando uma conexão esteja aberta.

![](https://i.imgur.com/sQxBOeD.png)

6. Mas como iremos saber qual porta esta aberta? Simples quando eu formo o three-way handshake, ele ira precisar finalizar a conexão em algum momento, sendo assim ira utilizar a flag **FIN** ou **F** no tcpdump, para confirmar a finalização o **FIN** é acompanhado pela flag **ACK** ou **.** no tcpdump, que confirma a finalização da conexão, sendo assim eu consigo descobrir em quais portas houve esse fim de conexão.
**OBS -> Para filtrar a flags que contem a confirmação da finalização no tcpdump, devo filtrar utilizando barra invertida, conforme o seguinte exemplo "F\.".

![](https://i.imgur.com/lQ3pvDd.png)
