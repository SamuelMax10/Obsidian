
---

Subdomain takeover (ou sequestro de subdomínio) é uma vulnerabilidade que ocorre quando um subdomínio de um site aponta para um serviço externo que não está mais sendo usado ou configurado corretamente. Um atacante pode reivindicar esse serviço e assumir o controle do subdomínio, podendo hospedar conteúdos maliciosos, coletar credenciais ou realizar ataques de phishing.

### Como acontece?

1. CNAME apontando para um serviço externo abandonado:
    - O subdomínio (`sub.exemplo.com`) pode estar configurado com um registro CNAME apontando para um serviço de terceiros (exemplo: GitHub Pages, AWS S3, Heroku).

    - Se o dono original removeu a instância no serviço, mas o CNAME ainda está ativo, um atacante pode registrar uma nova instância no mesmo serviço com o mesmo nome e assumir o subdomínio.

2. Serviços expirados ou deletados:
    - Plataformas como Shopify, Azure, CloudFront, entre outras, permitem que usuários escolham nomes personalizados.

    - Se o subdomínio de um serviço for liberado e alguém o reivindicar, ele pode ser usado para controle malicioso.


### Como identificar?

- Ferramentas como **Subjack, SubOver e HostileSubBruteforcer** podem detectar subdomínios vulneráveis.

- Um subdomínio vulnerável geralmente retorna um erro do tipo:
    - `No such bucket` (AWS S3)
    
    - `404 There isn't a GitHub Pages site here`
    
    - `The requested resource is not found` (Heroku)


### Como prevenir?

- **Remova registros DNS de subdomínios que não estão mais em uso**.

- **Monitore subdomínios ativos** para evitar apontamentos inválidos.

- **Use serviços que exigem validação antes de permitir domínios customizados**.



![](https://i.imgur.com/J5LMoED.png)
